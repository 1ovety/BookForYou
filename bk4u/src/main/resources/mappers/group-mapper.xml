<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="groupMapper">
	
	<resultMap type="GroupBoard" id="groupResult">
			<result column="group_boardno" property="groupBoardNo"/>
			<result column="group_type" property="groupType"/>
			<result column="group_title" property="groupTitle"/>
			<result column="group_script" property="groupScript"/>
			<result column="group_date" property="groupDate"/>
			<result column="group_limit" property="groupLimit"/>			
			<result column="group_notice" property="groupNotice"/>			
			<result column="group_place" property="groupPlace"/>			
			<result column="group_open" property="groupOpen"/>		
			<result column="origin_name" property="originName"/>
			<result column="change_name" property="changeName"/>
			<result column="group_writer" property="groupWriter"/>
						
	</resultMap>
	
	<resultMap type="GroupMember" id="gorupMemberResult">
		
			<result column="group_boardno" property="groupBoardNo"/>
			<result column="group_enrolldate" property="groupEnrollDate"/>
			<result column="mem_email" property="memEmail"/>
			<result column="group_level" property="groupLevel"/>
			<result column="group_withdraw" property="groupWithdraw"/>
			<result column="group_reason" property="groupReason"/>

		
			
			
	
	</resultMap>
	
	
	<select id="selectList" resultMap="groupResult" >
		SELECT 
            , group_boardno 
            , group_type
            , group_date
            , group_title
            , group_script
            , group_place
            , change_name
            
       from gorupBoard
      where group_status = 'Y'
             
       ORDER 
       	  BY GROUP_BOARDNO DESC
	
	
	</select>
	
	<select id="selectListCount" resultType="_int">
	
		select
				count(*)
		  from  board
		 where  status = 'Y'
		 	
	</select>
	
	<insert id="inserGMem">
		
		insert 
		  into groupMember
		  (
		  	group_boardno
		  ,	group_enrolldate
		  ,	mem_email
		  ,	group_level
		  )
		  values
		  (
		  	seq_gno.nextval
		  , #{gorupEnrollDate}
		  , #{mem_email}
		  , #{group_level}
		  )
			
	</insert>
	
	<select id="groupMemberList" resultType="groupMemberResult">
		select
		       group_boardno
		      ,group_enrolldate
		      ,group_email
		      ,group_level
		  from groupBoard
		  order
		  	 by group_enrolldate desc
				
	</select>
	
	<select id="selectSearchGListCount" resultType="_int">
		select
			   count(*)
	      from groupBoard
	     where 
	     		group_status='Y'

	</select>
	
	<select id="selectSearchList" resultMap="groupResult">
			SELECT *              
        FROM (SELECT ROWNUM NUM 
            , s.group_boardno 
            , s.group_type
            , s.group_title
            , s.group_script
            , s.group_place
            , s.change_name
            
              FROM GROUPBOARD 
            <choose>
            <when test="condition == 'groupTitle'">
            where group_title
           </when>
           <when test="condition == 'groupScript'">
            and group_script
            </when>
            <otherwise>
            and group_place
            </otherwise>
           </choose>
	     		like '%' || #{keyword} || '%'
             
             
                    ORDER BY GROUP_BOARDNO DESC)s)
                    where NUM between 1 and 4
	</select>


	<insert id="insertGBoard">
		insert
		  into groupBoard
		  (
		  group_boardno
		 ,group_type
		 ,group_title
		 ,group_place
		 ,group_script
		 ,group_limit
		 ,change_name
		 ,group_open
		  )
		  values
		  (
		  seq_gno.nextval
		 ,#{groupType}
		 ,#{groupTitle}
		 ,#{groupPlace}
		 ,#{groupScript}
		 ,#{groupLimit}
		 ,#{changeName}
		 ,#{groupOpen}
		  )
	
	</insert>
	
	<select id="selectGroup" resultMap="groupResult">
		select
		 		group_boardno
		 	 ,  group_title
		 	 ,  group_writer
		 	 , 	group_date
		 	 ,  group_enrolldate
			 ,  change_name
			 ,  group_script
			 ,  group_notice
	     from  groupBoard
	    where  group_boardNo = #{groupBoardNo}
	</select>
	
	
</mapper>
